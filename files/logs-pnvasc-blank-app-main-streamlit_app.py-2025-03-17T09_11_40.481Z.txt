
[ â€‰â€‰â€…â€…UTCâ€…â€…â€‰â€‰ ] Logs for blank-app-bnwcytsn3gb4k47qlahtrn.streamlit.app/
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[20:25:30] ğŸš€ Starting up repository: 'blank-app', branch: 'main', main module: 'streamlit_app.py'
[20:25:30] ğŸ™ Cloning repository...
[20:25:31] ğŸ™ Cloning into '/mount/src/blank-app'...

[20:25:31] ğŸ™ Cloned repository!
[20:25:31] ğŸ™ Pulling code changes from Github...
[20:25:32] ğŸ“¦ Processing dependencies...

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ uv â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Using uv pip install.
Using Python 3.12.9 environment at /home/adminuser/venv
Resolved 45 packages in 626ms
Prepared 45 packages in 7.75s
Installed 45 packages in 965ms
 + altair==5.5.0
 + attrs==25.3.0
 + blinker==1.9.0
 + cachetools==5.5.2
 + certifi==2025.1.31
 + charset-normalizer==3.4.1
 + click==8.1.8
 + contourpy==1.3.1
 + cycler==0.12.1
 + fonttools==4.56.0
 + gitdb==4.0.12
 + gitpython==3.1.44
 + idna==3.10
 + jinja2==3.1.6
 + jsonschema==4.23.0
 + jsonschema-specifications==2024.10.1
 + kiwisolver==1.4.8
 + markupsafe==3.0.2
 + matplotlib==3.10.1
 + narwhals==1.30.0
 + numpy==2.2.4
 + packaging==24.2
 + pandas==2.2.3
 + pillow==11.1.0
 + plotly==6.0.0
 + protobuf==5.29.3
 + pyarrow==19.0.1
 + pydeck==0.9.1
 + pyparsing==3.2.1
 + python-dateutil==2.9.0.post0
 + pytz==2025.1
 + referencing==0.36.2
 + requests==2.32.3
 + rpds-py==0.23.1
 + seaborn==0.13.2
 + [2025-03-16 20:25:42.265319] six==1.17.0
 + smmap==5.0.2
 + streamlit==1.43.2
 + tenacity==9.0.0
 + toml==0.10.2
 + tornado==6.4.2
 + typing-extensions==4.12.2
 + tzdata==2025.1
 + urllib3==2.3.0
 + watchdog==6.0.0
Checking if Streamlit is installed
Found Streamlit version 1.43.2 in the environment
Installing rich for an improved exception logging
Using uv pip install.
Using Python 3.12.9 environment at /home/adminuser/venv
Resolved 4 packages in 162ms
Prepared 4 packages in 134ms
Installed 4 packages in 16ms
 + markdown-it-py==3.0.0
 + mdurl==0.1.2
 + pygments==2.19.1
 + rich[2025-03-16 20:25:45.051092] ==13.9.4

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[20:25:46] ğŸ Python dependencies were installed from /mount/src/blank-app/requirements.txt using uv.
Check if streamlit is installed
Streamlit is already installed
[20:25:48] ğŸ“¦ Processed dependencies!



[20:34:28] ğŸ™ Pulling code changes from Github...
[20:34:28] ğŸ“¦ Processing dependencies...
[20:34:28] ğŸ“¦ Processed dependencies!
[20:34:30] ğŸ”„ Updated app!
[20:35:09] ğŸ™ Pulling code changes from Github...
[20:35:10] ğŸ“¦ Processing dependencies...
[20:35:10] ğŸ“¦ Processed dependencies!
[20:35:12] ğŸ”„ Updated app!
[21:02:38] ğŸ™ Pulling code changes from Github...
[21:02:39] ğŸ“¦ Processing dependencies...
[21:02:39] ğŸ“¦ Processed dependencies!
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:20 in <module>                          
                                                                                
     17 # Load your dataframes                                                  
     18 # Assuming these are already loaded in your environment                 
     19 # If not, you'll need to add code to load them from files               
  â±  20 data = pd.read_csv('NoA-Connect-JrDataScience-Case(in).csv')  # Origin  
     21 customer_features_clustered = pd.read_csv('customer_features_clustered  
     22 data['order_date'] = pd.to_datetime(data['order_date'])                 
     23                                                                         
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
NameError: name 'data' is not defined
[21:02:44] ğŸ”„ Updated app!
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:20 in <module>                          
                                                                                
     17 # Load your dataframes                                                  
     18 # Assuming these are already loaded in your environment                 
     19 # If not, you'll need to add code to load them from files               
  â±  20 data = data  # Original dataframe with order_date, currency, and purch  
     21 customer_features_clustered = customer_features_clustered  # Dataframe  
     22                                                                         
     23 # Title and description                                                 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
NameError: name 'data' is not defined
[21:04:08] ğŸ™ Pulling code changes from Github...
[21:04:09] ğŸ“¦ Processing dependencies...
[21:04:09] ğŸ“¦ Processed dependencies!
[21:04:11] ğŸ”„ Updated app!
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:20 in <module>                          
                                                                                
     17 # Load your dataframes                                                  
     18 # Assuming these are already loaded in your environment                 
     19 # If not, you'll need to add code to load them from files               
  â±  20 data = data  # Original dataframe with order_date, currency, and purch  
     21 customer_features_clustered = customer_features_clustered  # Dataframe  
     22                                                                         
     23 # Title and description                                                 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
NameError: name 'data' is not defined
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:20 in <module>                          
                                                                                
     17 # Load your dataframes                                                  
     18 # Assuming these are already loaded in your environment                 
     19 # If not, you'll need to add code to load them from files               
  â±  20 data = pd.read_csv('NoA-Connect-JrDataScience-Case(in).csv')  # Origin  
     21 customer_features_clustered = pd.read_csv('customer_features_clustered  
     22                                                                         
     23 # Title and description                                                 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
NameError: name 'data' is not defined
[21:05:32] â—ï¸ 
2025-03-16 21:05:32.379 503 GET /script-health-check (127.0.0.1) 360.82ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:20 in <module>                          
                                                                                
     17 # Load your dataframes                                                  
     18 # Assuming these are already loaded in your environment                 
     19 # If not, you'll need to add code to load them from files               
  â±  20 data = pd.read_csv('NoA-Connect-JrDataScience-Case(in).csv')  # Origin  
     21 customer_features_clustered = pd.read_csv('customer_features_clustered  
     22                                                                         
     23 # Title and description                                                 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
NameError: name 'data' is not defined
2025-03-16 21:05:37.349 503 GET /script-health-check (127.0.0.1) 334.23ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:20 in <module>                          
                                                                                
     17 # Load your dataframes                                                  
     18 # Assuming these are already loaded in your environment                 
     19 # If not, you'll need to add code to load them from files               
  â±  20 data = pd.read_csv('NoA-Connect-JrDataScience-Case(in).csv')  # Origin  
     21 customer_features_clustered = pd.read_csv('customer_features_clustered  
     22                                                                         
     23 # Title and description                                                 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
NameError: name 'data' is not defined
2025-03-16 21:05:42.420 503 GET /script-health-check (127.0.0.1) 289.71ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:20 in <module>                          
                                                                                
     17 # Load your dataframes                                                  
     18 # Assuming these are already loaded in your environment                 
     19 # If not, you'll need to add code to load them from files               
  â±  20 data = pd.read_csv('NoA-Connect-JrDataScience-Case(in).csv')  # Origin  
     21 customer_features_clustered = pd.read_csv('customer_features_clustered  
     22                                                                         
     23 # Title and description                                                 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
NameError: name 'data' is not defined
2025-03-16 21:05:47.403 503 GET /script-health-check (127.0.0.1) 386.89ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:20 in <module>                          
                                                                                
     17 # Load your dataframes                                                  
     18 # Assuming these are already loaded in your environment                 
     19 # If not, you'll need to add code to load them from files               
  â±  20 data = pd.read_csv('NoA-Connect-JrDataScience-Case(in).csv')  # Origin  
     21 customer_features_clustered = pd.read_csv('customer_features_clustered  
     22                                                                         
     23 # Title and description                                                 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
NameError: name 'data' is not defined
2025-03-16 21:05:52.363 503 GET /script-health-check (127.0.0.1) 319.76ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:20 in <module>                          
                                                                                
     17 # Load your dataframes                                                  
     18 # Assuming these are already loaded in your environment                 
     19 # If not, you'll need to add code to load them from files               
  â±  20 data = pd.read_csv('NoA-Connect-JrDataScience-Case(in).csv')  # Origin  
     21 customer_features_clustered = pd.read_csv('customer_features_clustered  
     22                                                                         
     23 # Title and description                                                 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
NameError: name 'data' is not defined
2025-03-16 21:05:57.352 503 GET /script-health-check (127.0.0.1) 347.06ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:20 in <module>                          
                                                                                
     17 # Load your dataframes                                                  
     18 # Assuming these are already loaded in your environment                 
     19 # If not, you'll need to add code to load them from files               
  â±  20 data = pd.read_csv('NoA-Connect-JrDataScience-Case(in).csv')  # Origin  
     21 customer_features_clustered = pd.read_csv('customer_features_clustered  
     22                                                                         
     23 # Title and description                                                 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
NameError: name 'data' is not defined
2025-03-16 21:06:02.409 503 GET /script-health-check (127.0.0.1) 301.07ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:20 in <module>                          
                                                                                
     17 # Load your dataframes                                                  
     18 # Assuming these are already loaded in your environment                 
     19 # If not, you'll need to add code to load them from files               
  â±  20 data = pd.read_csv('NoA-Connect-JrDataScience-Case(in).csv')  # Origin  
     21 customer_features_clustered = pd.read_csv('customer_features_clustered  
     22                                                                         
     23 # Title and description                                                 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
NameError: name 'data' is not defined
2025-03-16 21:06:07.732 503 GET /script-health-check (127.0.0.1) 397.95ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:20 in <module>                          
                                                                                
     17 # Load your dataframes                                                  
     18 # Assuming these are already loaded in your environment                 
     19 # If not, you'll need to add code to load them from files               
  â±  20 data = pd.read_csv('NoA-Connect-JrDataScience-Case(in).csv')  # Origin  
     21 customer_features_clustered = pd.read_csv('customer_features_clustered  
     22                                                                         
     23 # Title and description                                                 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
NameError: name 'data' is not defined
2025-03-16 21:06:12.534 503 GET /script-health-check (127.0.0.1) 408.76ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:20 in <module>                          
                                                                                
     17 # Load your dataframes                                                  
     18 # Assuming these are already loaded in your environment                 
     19 # If not, you'll need to add code to load them from files               
  â±  20 data = pd.read_csv('NoA-Connect-JrDataScience-Case(in).csv')  # Origin  
     21 customer_features_clustered = pd.read_csv('customer_features_clustered  
     22                                                                         
     23 # Title and description                                                 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
NameError: name 'data' is not defined
2025-03-16 21:06:17.562 503 GET /script-health-check (127.0.0.1) 356.27ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:20 in <module>                          
                                                                                
     17 # Load your dataframes                                                  
     18 # Assuming these are already loaded in your environment                 
     19 # If not, you'll need to add code to load them from files               
  â±  20 data = pd.read_csv('NoA-Connect-JrDataScience-Case(in).csv')  # Origin  
     21 customer_features_clustered = pd.read_csv('customer_features_clustered  
     22                                                                         
     23 # Title and description                                                 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
NameError: name 'data' is not defined
2025-03-16 21:06:22.832 503 GET /script-health-check (127.0.0.1) 418.50ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:20 in <module>                          
                                                                                
     17 # Load your dataframes                                                  
     18 # Assuming these are already loaded in your environment                 
     19 # If not, you'll need to add code to load them from files               
  â±  20 data = pd.read_csv('NoA-Connect-JrDataScience-Case(in).csv')  # Origin  
     21 customer_features_clustered = pd.read_csv('customer_features_clustered  
     22                                                                         
     23 # Title and description                                                 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
NameError: name 'data' is not defined
2025-03-16 21:06:27.543 503 GET /script-health-check (127.0.0.1) 388.50ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:20 in <module>                          
                                                                                
     17 # Load your dataframes                                                  
     18 # Assuming these are already loaded in your environment                 
     19 # If not, you'll need to add code to load them from files               
  â±  20 data = pd.read_csv('NoA-Connect-JrDataScience-Case(in).csv')  # Origin  
     21 customer_features_clustered = pd.read_csv('customer_features_clustered  
     22                                                                         
     23 # Title and description                                                 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
NameError: name 'data' is not defined
2025-03-16 21:06:32.636 503 GET /script-health-check (127.0.0.1) 402.80ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:20 in <module>                          
                                                                                
     17 # Load your dataframes                                                  
     18 # Assuming these are already loaded in your environment                 
     19 # If not, you'll need to add code to load them from files               
  â±  20 data = pd.read_csv('NoA-Connect-JrDataScience-Case(in).csv')  # Origin  
     21 customer_features_clustered = pd.read_csv('customer_features_clustered  
     22                                                                         
     23 # Title and description                                                 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
NameError: name 'data' is not defined
2025-03-16 21:06:37.533 503 GET /script-health-check (127.0.0.1) 404.32ms
[21:06:38] ğŸ™ Pulling code changes from Github...
[21:06:38] ğŸ“¦ Processing dependencies...
[21:06:38] ğŸ“¦ Processed dependencies!
[21:06:41] ğŸ”„ Updated app!
[07:59:09] ğŸ™ Pulling code changes from Github...
[07:59:10] ğŸ“¦ Processing dependencies...
[07:59:10] ğŸ“¦ Processed dependencies!
[07:59:12] ğŸ”„ Updated app!
[09:09:24] ğŸ™ Pulling code changes from Github...
[09:09:26] ğŸ“¦ Processing dependencies...

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ uv â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Using uv pip install.
Using Python 3.12.9 environment at /home/adminuser/venv
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:147 in <module>                         
                                                                                
    144 â”‚   }).reset_index()                                                    
    145 â”‚                                                                       
    146 â”‚   cluster_metrics['Segment'] = cluster_metrics['cluster'].map({       
  â± 147 â”‚   â”‚   1: "High-Value Loyalists",                                      
    148 â”‚   â”‚   0: "Occasional Buyers"                                          
    149 â”‚   })                                                                  
    150                                                                         
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/groupby/generi  
  c.py:1432 in aggregate                                                        
                                                                                
    1429 â”‚   â”‚   â”‚   kwargs["engine_kwargs"] = engine_kwargs                    
    1430 â”‚   â”‚                                                                  
    1431 â”‚   â”‚   op = GroupByApply(self, func, args=args, kwargs=kwargs)        
  â± 1432 â”‚   â”‚   result = op.agg()                                              
    1433 â”‚   â”‚   if not is_dict_like(func) and result is not None:              
    1434 â”‚   â”‚   â”‚   # GH #52849                                                
    1435 â”‚   â”‚   â”‚   if not self.as_index and is_list_like(func):               
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:190    
  in agg                                                                        
                                                                                
     187 â”‚   â”‚   â”‚   return self.apply_str()                                    
     188 â”‚   â”‚                                                                  
     189 â”‚   â”‚   if is_dict_like(func):                                         
  â±  190 â”‚   â”‚   â”‚   return self.agg_dict_like()                                
     191 â”‚   â”‚   elif is_list_like(func):                                       
     192 â”‚   â”‚   â”‚   # we require a list, but not a 'str'                       
     193 â”‚   â”‚   â”‚   return self.agg_list_like()                                
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:423    
  in agg_dict_like                                                              
                                                                                
     420 â”‚   â”‚   -------                                                        
     421 â”‚   â”‚   Result of aggregation.                                         
     422 â”‚   â”‚   """                                                            
  â±  423 â”‚   â”‚   return self.agg_or_apply_dict_like(op_name="agg")              
     424 â”‚                                                                      
     425 â”‚   def compute_dict_like(                                             
     426 â”‚   â”‚   self,                                                          
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:1608   
  in agg_or_apply_dict_like                                                     
                                                                                
    1605 â”‚   â”‚   with com.temp_setattr(                                         
    1606 â”‚   â”‚   â”‚   obj, "as_index", True, condition=hasattr(obj, "as_index")  
    1607 â”‚   â”‚   ):                                                             
  â± 1608 â”‚   â”‚   â”‚   result_index, result_data = self.compute_dict_like(        
    1609 â”‚   â”‚   â”‚   â”‚   op_name, selected_obj, selection, kwargs               
    1610 â”‚   â”‚   â”‚   )                                                          
    1611 â”‚   â”‚   result = self.wrap_results_dict_like(selected_obj, result_ind  
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:462    
  in compute_dict_like                                                          
                                                                                
     459 â”‚   â”‚   obj = self.obj                                                 
     460 â”‚   â”‚   is_groupby = isinstance(obj, (DataFrameGroupBy, SeriesGroupBy  
     461 â”‚   â”‚   func = cast(AggFuncTypeDict, self.func)                        
  â±  462 â”‚   â”‚   func = self.normalize_dictlike_arg(op_name, selected_obj, fun  
     463 â”‚   â”‚                                                                  
     464 â”‚   â”‚   is_non_unique_col = (                                          
     465 â”‚   â”‚   â”‚   selected_obj.ndim == 2                                     
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:663    
  in normalize_dictlike_arg                                                     
                                                                                
     660 â”‚   â”‚   â”‚                                                              
     661 â”‚   â”‚   â”‚   cols = Index(list(func.keys())).difference(obj.columns, s  
     662 â”‚   â”‚   â”‚   if len(cols) > 0:                                          
  â±  663 â”‚   â”‚   â”‚   â”‚   raise KeyError(f"Column(s) {list(cols)} do not exist"  
     664 â”‚   â”‚                                                                  
     665 â”‚   â”‚   aggregator_types = (list, tuple, dict)                         
     666                                                                        
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
KeyError: "Column(s) ['customer_value_score'] do not exist"
Resolved 87 packages in 2.08s
Prepared [2025-03-17 09:10:11.756719] 43 packages[2025-03-17 09:10:11.757063]  [2025-03-17 09:10:11.757305] in 42.22s[2025-03-17 09:10:11.757500] 
Uninstalled 1 package in 44ms
Installed 43 packages in 600ms
 + annotated-types==0.7.0
 + dacite==1.9.2
 + filelock==3.18.0
 + fsspec==2025.3.0
 + htmlmin==0.1.12
 + imagehash==4.3.1
 + joblib==1.4.2
 + mpmath==1.3.0
 + multimethod==1.12
 + networkx==3.4.2
 - numpy==2.2.4
 [2025-03-17 09:10:12.372587] + numpy==2.1.3
 + nvidia-cublas-cu12==12.4.5.8
 + nvidia-cuda-cupti-cu12==12.4.127
 + nvidia-cuda-nvrtc-cu12==12.4.127
 + nvidia-cuda-runtime-cu12==12.4.127
 + nvidia-cudnn-cu12==9.1.0.70
 + nvidia-cufft-cu12==11.2.1.3
 + nvidia-curand-cu12==10.3.5.147
 + nvidia-cusolver-cu12==11.6.1.9
 [2025-03-17 09:10:12.372863] + nvidia-cusparse-cu12==12.3.1.170
 + nvidia-cusparselt-cu12==0.6.2
 + nvidia-nccl-cu12==2.21.5
 + nvidia-nvjitlink-cu12==12.4.127
 + nvidia-nvtx-cu12==12.4.127
 + patsy==1.0.1
 + [2025-03-17 09:10:12.373023] phik==0.12.4
 + pydantic==2.10.6
 + pydantic-core==2.27.2
 + pywavelets==1.8.0
 + pyyaml==6.0.2
 + scikit-learn==1.6.1
 + scipy==[2025-03-17 09:10:12.373198] 1.15.2
 + setuptools==76.0.0
 + statsmodels==0.14.4
 + sympy==1.13.1
 + threadpoolctl==3.6.0
 + torch==2.6.0
 + tqdm==4.67.1
 + [2025-03-17 09:10:12.373420] triton==3.2.0
 + typeguard==4.4.2
 + visions==0.7.6
 + wordcloud==1.9.4
 + ydata-profiling==4.12.2
Checking if Streamlit is installed
Found Streamlit version 1.43.2 in the environment
Installing rich for an improved exception logging
Using uv pip install.
Using Python 3.12.9 environment at /home/adminuser/venv
Audited 1 package in 108ms

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[09:10:15] ğŸ Python dependencies were installed from /mount/src/blank-app/requirements.txt using uv.
[09:10:15] ğŸ“¦ Processed dependencies!
  Stopping...



[09:10:18] ğŸ”„ Updated app!
[09:10:30] ğŸ™ Pulling code changes from Github...
[09:10:31] ğŸ“¦ Processing dependencies...
[09:10:31] ğŸ“¦ Processed dependencies!
[09:10:33] ğŸ”„ Updated app!
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:147 in <module>                         
                                                                                
    144 â”‚   st.subheader("Average Metrics by Segment")                          
    145 â”‚                                                                       
    146 â”‚   # Calculate average metrics for each cluster                        
  â± 147 â”‚   cluster_metrics = filtered_customers.groupby('cluster').agg({       
    148 â”‚   â”‚   'monetary': 'mean',                                             
    149 â”‚   â”‚   'frequency': 'mean',                                            
    150 â”‚   â”‚   'recency': 'mean',                                              
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/groupby/generi  
  c.py:1432 in aggregate                                                        
                                                                                
    1429 â”‚   â”‚   â”‚   kwargs["engine_kwargs"] = engine_kwargs                    
    1430 â”‚   â”‚                                                                  
    1431 â”‚   â”‚   op = GroupByApply(self, func, args=args, kwargs=kwargs)        
  â± 1432 â”‚   â”‚   result = op.agg()                                              
    1433 â”‚   â”‚   if not is_dict_like(func) and result is not None:              
    1434 â”‚   â”‚   â”‚   # GH #52849                                                
    1435 â”‚   â”‚   â”‚   if not self.as_index and is_list_like(func):               
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:190    
  in agg                                                                        
                                                                                
     187 â”‚   â”‚   â”‚   return self.apply_str()                                    
     188 â”‚   â”‚                                                                  
     189 â”‚   â”‚   if is_dict_like(func):                                         
  â±  190 â”‚   â”‚   â”‚   return self.agg_dict_like()                                
     191 â”‚   â”‚   elif is_list_like(func):                                       
     192 â”‚   â”‚   â”‚   # we require a list, but not a 'str'                       
     193 â”‚   â”‚   â”‚   return self.agg_list_like()                                
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:423    
  in agg_dict_like                                                              
                                                                                
     420 â”‚   â”‚   -------                                                        
     421 â”‚   â”‚   Result of aggregation.                                         
     422 â”‚   â”‚   """                                                            
  â±  423 â”‚   â”‚   return self.agg_or_apply_dict_like(op_name="agg")              
     424 â”‚                                                                      
     425 â”‚   def compute_dict_like(                                             
     426 â”‚   â”‚   self,                                                          
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:1608   
  in agg_or_apply_dict_like                                                     
                                                                                
    1605 â”‚   â”‚   with com.temp_setattr(                                         
    1606 â”‚   â”‚   â”‚   obj, "as_index", True, condition=hasattr(obj, "as_index")  
    1607 â”‚   â”‚   ):                                                             
  â± 1608 â”‚   â”‚   â”‚   result_index, result_data = self.compute_dict_like(        
    1609 â”‚   â”‚   â”‚   â”‚   op_name, selected_obj, selection, kwargs               
    1610 â”‚   â”‚   â”‚   )                                                          
    1611 â”‚   â”‚   result = self.wrap_results_dict_like(selected_obj, result_ind  
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:462    
  in compute_dict_like                                                          
                                                                                
     459 â”‚   â”‚   obj = self.obj                                                 
     460 â”‚   â”‚   is_groupby = isinstance(obj, (DataFrameGroupBy, SeriesGroupBy  
     461 â”‚   â”‚   func = cast(AggFuncTypeDict, self.func)                        
  â±  462 â”‚   â”‚   func = self.normalize_dictlike_arg(op_name, selected_obj, fun  
     463 â”‚   â”‚                                                                  
     464 â”‚   â”‚   is_non_unique_col = (                                          
     465 â”‚   â”‚   â”‚   selected_obj.ndim == 2                                     
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:663    
  in normalize_dictlike_arg                                                     
                                                                                
     660 â”‚   â”‚   â”‚                                                              
     661 â”‚   â”‚   â”‚   cols = Index(list(func.keys())).difference(obj.columns, s  
     662 â”‚   â”‚   â”‚   if len(cols) > 0:                                          
  â±  663 â”‚   â”‚   â”‚   â”‚   raise KeyError(f"Column(s) {list(cols)} do not exist"  
     664 â”‚   â”‚                                                                  
     665 â”‚   â”‚   aggregator_types = (list, tuple, dict)                         
     666                                                                        
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
KeyError: "Column(s) ['customer_value_score'] do not exist"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:147 in <module>                         
                                                                                
    144 â”‚   st.subheader("Average Metrics by Segment")                          
    145 â”‚                                                                       
    146 â”‚   # Calculate average metrics for each cluster                        
  â± 147 â”‚   cluster_metrics = filtered_customers.groupby('cluster').agg({       
    148 â”‚   â”‚   'monetary': 'mean',                                             
    149 â”‚   â”‚   'frequency': 'mean',                                            
    150 â”‚   â”‚   'recency': 'mean',                                              
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/groupby/generi  
  c.py:1432 in aggregate                                                        
                                                                                
    1429 â”‚   â”‚   â”‚   kwargs["engine_kwargs"] = engine_kwargs                    
    1430 â”‚   â”‚                                                                  
    1431 â”‚   â”‚   op = GroupByApply(self, func, args=args, kwargs=kwargs)        
  â± 1432 â”‚   â”‚   result = op.agg()                                              
    1433 â”‚   â”‚   if not is_dict_like(func) and result is not None:              
    1434 â”‚   â”‚   â”‚   # GH #52849                                                
    1435 â”‚   â”‚   â”‚   if not self.as_index and is_list_like(func):               
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:190    
  in agg                                                                        
                                                                                
     187 â”‚   â”‚   â”‚   return self.apply_str()                                    
     188 â”‚   â”‚                                                                  
     189 â”‚   â”‚   if is_dict_like(func):                                         
  â±  190 â”‚   â”‚   â”‚   return self.agg_dict_like()                                
     191 â”‚   â”‚   elif is_list_like(func):                                       
     192 â”‚   â”‚   â”‚   # we require a list, but not a 'str'                       
     193 â”‚   â”‚   â”‚   return self.agg_list_like()                                
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:423    
  in agg_dict_like                                                              
                                                                                
     420 â”‚   â”‚   -------                                                        
     421 â”‚   â”‚   Result of aggregation.                                         
     422 â”‚   â”‚   """                                                            
  â±  423 â”‚   â”‚   return self.agg_or_apply_dict_like(op_name="agg")              
     424 â”‚                                                                      
     425 â”‚   def compute_dict_like(                                             
     426 â”‚   â”‚   self,                                                          
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:1608   
  in agg_or_apply_dict_like                                                     
                                                                                
    1605 â”‚   â”‚   with com.temp_setattr(                                         
    1606 â”‚   â”‚   â”‚   obj, "as_index", True, condition=hasattr(obj, "as_index")  
    1607 â”‚   â”‚   ):                                                             
  â± 1608 â”‚   â”‚   â”‚   result_index, result_data = self.compute_dict_like(        
    1609 â”‚   â”‚   â”‚   â”‚   op_name, selected_obj, selection, kwargs               
    1610 â”‚   â”‚   â”‚   )                                                          
    1611 â”‚   â”‚   result = self.wrap_results_dict_like(selected_obj, result_ind  
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:462    
  in compute_dict_like                                                          
                                                                                
     459 â”‚   â”‚   obj = self.obj                                                 
     460 â”‚   â”‚   is_groupby = isinstance(obj, (DataFrameGroupBy, SeriesGroupBy  
     461 â”‚   â”‚   func = cast(AggFuncTypeDict, self.func)                        
  â±  462 â”‚   â”‚   func = self.normalize_dictlike_arg(op_name, selected_obj, fun  
     463 â”‚   â”‚                                                                  
     464 â”‚   â”‚   is_non_unique_col = (                                          
     465 â”‚   â”‚   â”‚   selected_obj.ndim == 2                                     
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:663    
  in normalize_dictlike_arg                                                     
                                                                                
     660 â”‚   â”‚   â”‚                                                              
     661 â”‚   â”‚   â”‚   cols = Index(list(func.keys())).difference(obj.columns, s  
     662 â”‚   â”‚   â”‚   if len(cols) > 0:                                          
  â±  663 â”‚   â”‚   â”‚   â”‚   raise KeyError(f"Column(s) {list(cols)} do not exist"  
     664 â”‚   â”‚                                                                  
     665 â”‚   â”‚   aggregator_types = (list, tuple, dict)                         
     666                                                                        
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
KeyError: "Column(s) ['customer_value_score'] do not exist"
[09:10:35] â—ï¸ 
2025-03-17 09:10:35.990 503 GET /script-health-check (127.0.0.1) 1547.46ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:147 in <module>                         
                                                                                
    144 â”‚   st.subheader("Average Metrics by Segment")                          
    145 â”‚                                                                       
    146 â”‚   # Calculate average metrics for each cluster                        
  â± 147 â”‚   cluster_metrics = filtered_customers.groupby('cluster').agg({       
    148 â”‚   â”‚   'monetary': 'mean',                                             
    149 â”‚   â”‚   'frequency': 'mean',                                            
    150 â”‚   â”‚   'recency': 'mean',                                              
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/groupby/generi  
  c.py:1432 in aggregate                                                        
                                                                                
    1429 â”‚   â”‚   â”‚   kwargs["engine_kwargs"] = engine_kwargs                    
    1430 â”‚   â”‚                                                                  
    1431 â”‚   â”‚   op = GroupByApply(self, func, args=args, kwargs=kwargs)        
  â± 1432 â”‚   â”‚   result = op.agg()                                              
    1433 â”‚   â”‚   if not is_dict_like(func) and result is not None:              
    1434 â”‚   â”‚   â”‚   # GH #52849                                                
    1435 â”‚   â”‚   â”‚   if not self.as_index and is_list_like(func):               
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:190    
  in agg                                                                        
                                                                                
     187 â”‚   â”‚   â”‚   return self.apply_str()                                    
     188 â”‚   â”‚                                                                  
     189 â”‚   â”‚   if is_dict_like(func):                                         
  â±  190 â”‚   â”‚   â”‚   return self.agg_dict_like()                                
     191 â”‚   â”‚   elif is_list_like(func):                                       
     192 â”‚   â”‚   â”‚   # we require a list, but not a 'str'                       
     193 â”‚   â”‚   â”‚   return self.agg_list_like()                                
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:423    
  in agg_dict_like                                                              
                                                                                
     420 â”‚   â”‚   -------                                                        
     421 â”‚   â”‚   Result of aggregation.                                         
     422 â”‚   â”‚   """                                                            
  â±  423 â”‚   â”‚   return self.agg_or_apply_dict_like(op_name="agg")              
     424 â”‚                                                                      
     425 â”‚   def compute_dict_like(                                             
     426 â”‚   â”‚   self,                                                          
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:1608   
  in agg_or_apply_dict_like                                                     
                                                                                
    1605 â”‚   â”‚   with com.temp_setattr(                                         
    1606 â”‚   â”‚   â”‚   obj, "as_index", True, condition=hasattr(obj, "as_index")  
    1607 â”‚   â”‚   ):                                                             
  â± 1608 â”‚   â”‚   â”‚   result_index, result_data = self.compute_dict_like(        
    1609 â”‚   â”‚   â”‚   â”‚   op_name, selected_obj, selection, kwargs               
    1610 â”‚   â”‚   â”‚   )                                                          
    1611 â”‚   â”‚   result = self.wrap_results_dict_like(selected_obj, result_ind  
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:462    
  in compute_dict_like                                                          
                                                                                
     459 â”‚   â”‚   obj = self.obj                                                 
     460 â”‚   â”‚   is_groupby = isinstance(obj, (DataFrameGroupBy, SeriesGroupBy  
     461 â”‚   â”‚   func = cast(AggFuncTypeDict, self.func)                        
  â±  462 â”‚   â”‚   func = self.normalize_dictlike_arg(op_name, selected_obj, fun  
     463 â”‚   â”‚                                                                  
     464 â”‚   â”‚   is_non_unique_col = (                                          
     465 â”‚   â”‚   â”‚   selected_obj.ndim == 2                                     
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:663    
  in normalize_dictlike_arg                                                     
                                                                                
     660 â”‚   â”‚   â”‚                                                              
     661 â”‚   â”‚   â”‚   cols = Index(list(func.keys())).difference(obj.columns, s  
     662 â”‚   â”‚   â”‚   if len(cols) > 0:                                          
  â±  663 â”‚   â”‚   â”‚   â”‚   raise KeyError(f"Column(s) {list(cols)} do not exist"  
     664 â”‚   â”‚                                                                  
     665 â”‚   â”‚   aggregator_types = (list, tuple, dict)                         
     666                                                                        
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
KeyError: "Column(s) ['customer_value_score'] do not exist"
2025-03-17 09:10:40.305 503 GET /script-health-check (127.0.0.1) 937.03ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:147 in <module>                         
                                                                                
    144 â”‚   st.subheader("Average Metrics by Segment")                          
    145 â”‚                                                                       
    146 â”‚   # Calculate average metrics for each cluster                        
  â± 147 â”‚   cluster_metrics = filtered_customers.groupby('cluster').agg({       
    148 â”‚   â”‚   'monetary': 'mean',                                             
    149 â”‚   â”‚   'frequency': 'mean',                                            
    150 â”‚   â”‚   'recency': 'mean',                                              
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/groupby/generi  
  c.py:1432 in aggregate                                                        
                                                                                
    1429 â”‚   â”‚   â”‚   kwargs["engine_kwargs"] = engine_kwargs                    
    1430 â”‚   â”‚                                                                  
    1431 â”‚   â”‚   op = GroupByApply(self, func, args=args, kwargs=kwargs)        
  â± 1432 â”‚   â”‚   result = op.agg()                                              
    1433 â”‚   â”‚   if not is_dict_like(func) and result is not None:              
    1434 â”‚   â”‚   â”‚   # GH #52849                                                
    1435 â”‚   â”‚   â”‚   if not self.as_index and is_list_like(func):               
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:190    
  in agg                                                                        
                                                                                
     187 â”‚   â”‚   â”‚   return self.apply_str()                                    
     188 â”‚   â”‚                                                                  
     189 â”‚   â”‚   if is_dict_like(func):                                         
  â±  190 â”‚   â”‚   â”‚   return self.agg_dict_like()                                
     191 â”‚   â”‚   elif is_list_like(func):                                       
     192 â”‚   â”‚   â”‚   # we require a list, but not a 'str'                       
     193 â”‚   â”‚   â”‚   return self.agg_list_like()                                
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:423    
  in agg_dict_like                                                              
                                                                                
     420 â”‚   â”‚   -------                                                        
     421 â”‚   â”‚   Result of aggregation.                                         
     422 â”‚   â”‚   """                                                            
  â±  423 â”‚   â”‚   return self.agg_or_apply_dict_like(op_name="agg")              
     424 â”‚                                                                      
     425 â”‚   def compute_dict_like(                                             
     426 â”‚   â”‚   self,                                                          
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:1608   
  in agg_or_apply_dict_like                                                     
                                                                                
    1605 â”‚   â”‚   with com.temp_setattr(                                         
    1606 â”‚   â”‚   â”‚   obj, "as_index", True, condition=hasattr(obj, "as_index")  
    1607 â”‚   â”‚   ):                                                             
  â± 1608 â”‚   â”‚   â”‚   result_index, result_data = self.compute_dict_like(        
    1609 â”‚   â”‚   â”‚   â”‚   op_name, selected_obj, selection, kwargs               
    1610 â”‚   â”‚   â”‚   )                                                          
    1611 â”‚   â”‚   result = self.wrap_results_dict_like(selected_obj, result_ind  
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:462    
  in compute_dict_like                                                          
                                                                                
     459 â”‚   â”‚   obj = self.obj                                                 
     460 â”‚   â”‚   is_groupby = isinstance(obj, (DataFrameGroupBy, SeriesGroupBy  
     461 â”‚   â”‚   func = cast(AggFuncTypeDict, self.func)                        
  â±  462 â”‚   â”‚   func = self.normalize_dictlike_arg(op_name, selected_obj, fun  
     463 â”‚   â”‚                                                                  
     464 â”‚   â”‚   is_non_unique_col = (                                          
     465 â”‚   â”‚   â”‚   selected_obj.ndim == 2                                     
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:663    
  in normalize_dictlike_arg                                                     
                                                                                
     660 â”‚   â”‚   â”‚                                                              
     661 â”‚   â”‚   â”‚   cols = Index(list(func.keys())).difference(obj.columns, s  
     662 â”‚   â”‚   â”‚   if len(cols) > 0:                                          
  â±  663 â”‚   â”‚   â”‚   â”‚   raise KeyError(f"Column(s) {list(cols)} do not exist"  
     664 â”‚   â”‚                                                                  
     665 â”‚   â”‚   aggregator_types = (list, tuple, dict)                         
     666                                                                        
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
KeyError: "Column(s) ['customer_value_score'] do not exist"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:147 in <module>                         
                                                                                
    144 â”‚   st.subheader("Average Metrics by Segment")                          
    145 â”‚                                                                       
    146 â”‚   # Calculate average metrics for each cluster                        
  â± 147 â”‚   cluster_metrics = filtered_customers.groupby('cluster').agg({       
    148 â”‚   â”‚   'monetary': 'mean',                                             
    149 â”‚   â”‚   'frequency': 'mean',                                            
    150 â”‚   â”‚   'recency': 'mean',                                              
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/groupby/generi  
  c.py:1432 in aggregate                                                        
                                                                                
    1429 â”‚   â”‚   â”‚   kwargs["engine_kwargs"] = engine_kwargs                    
    1430 â”‚   â”‚                                                                  
    1431 â”‚   â”‚   op = GroupByApply(self, func, args=args, kwargs=kwargs)        
  â± 1432 â”‚   â”‚   result = op.agg()                                              
    1433 â”‚   â”‚   if not is_dict_like(func) and result is not None:              
    1434 â”‚   â”‚   â”‚   # GH #52849                                                
    1435 â”‚   â”‚   â”‚   if not self.as_index and is_list_like(func):               
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:190    
  in agg                                                                        
                                                                                
     187 â”‚   â”‚   â”‚   return self.apply_str()                                    
     188 â”‚   â”‚                                                                  
     189 â”‚   â”‚   if is_dict_like(func):                                         
  â±  190 â”‚   â”‚   â”‚   return self.agg_dict_like()                                
     191 â”‚   â”‚   elif is_list_like(func):                                       
     192 â”‚   â”‚   â”‚   # we require a list, but not a 'str'                       
     193 â”‚   â”‚   â”‚   return self.agg_list_like()                                
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:423    
  in agg_dict_like                                                              
                                                                                
     420 â”‚   â”‚   -------                                                        
     421 â”‚   â”‚   Result of aggregation.                                         
     422 â”‚   â”‚   """                                                            
  â±  423 â”‚   â”‚   return self.agg_or_apply_dict_like(op_name="agg")              
     424 â”‚                                                                      
     425 â”‚   def compute_dict_like(                                             
     426 â”‚   â”‚   self,                                                          
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:1608   
  in agg_or_apply_dict_like                                                     
                                                                                
    1605 â”‚   â”‚   with com.temp_setattr(                                         
    1606 â”‚   â”‚   â”‚   obj, "as_index", True, condition=hasattr(obj, "as_index")  
    1607 â”‚   â”‚   ):                                                             
  â± 1608 â”‚   â”‚   â”‚   result_index, result_data = self.compute_dict_like(        
    1609 â”‚   â”‚   â”‚   â”‚   op_name, selected_obj, selection, kwargs               
    1610 â”‚   â”‚   â”‚   )                                                          
    1611 â”‚   â”‚   result = self.wrap_results_dict_like(selected_obj, result_ind  
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:462    
  in compute_dict_like                                                          
                                                                                
     459 â”‚   â”‚   obj = self.obj                                                 
     460 â”‚   â”‚   is_groupby = isinstance(obj, (DataFrameGroupBy, SeriesGroupBy  
     461 â”‚   â”‚   func = cast(AggFuncTypeDict, self.func)                        
  â±  462 â”‚   â”‚   func = self.normalize_dictlike_arg(op_name, selected_obj, fun  
     463 â”‚   â”‚                                                                  
     464 â”‚   â”‚   is_non_unique_col = (                                          
     465 â”‚   â”‚   â”‚   selected_obj.ndim == 2                                     
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:663    
  in normalize_dictlike_arg                                                     
                                                                                
     660 â”‚   â”‚   â”‚                                                              
     661 â”‚   â”‚   â”‚   cols = Index(list(func.keys())).difference(obj.columns, s  
     662 â”‚   â”‚   â”‚   if len(cols) > 0:                                          
  â±  663 â”‚   â”‚   â”‚   â”‚   raise KeyError(f"Column(s) {list(cols)} do not exist"  
     664 â”‚   â”‚                                                                  
     665 â”‚   â”‚   aggregator_types = (list, tuple, dict)                         
     666                                                                        
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
KeyError: "Column(s) ['customer_value_score'] do not exist"
2025-03-17 09:10:45.305 503 GET /script-health-check (127.0.0.1) 934.79ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:147 in <module>                         
                                                                                
    144 â”‚   st.subheader("Average Metrics by Segment")                          
    145 â”‚                                                                       
    146 â”‚   # Calculate average metrics for each cluster                        
  â± 147 â”‚   cluster_metrics = filtered_customers.groupby('cluster').agg({       
    148 â”‚   â”‚   'monetary': 'mean',                                             
    149 â”‚   â”‚   'frequency': 'mean',                                            
    150 â”‚   â”‚   'recency': 'mean',                                              
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/groupby/generi  
  c.py:1432 in aggregate                                                        
                                                                                
    1429 â”‚   â”‚   â”‚   kwargs["engine_kwargs"] = engine_kwargs                    
    1430 â”‚   â”‚                                                                  
    1431 â”‚   â”‚   op = GroupByApply(self, func, args=args, kwargs=kwargs)        
  â± 1432 â”‚   â”‚   result = op.agg()                                              
    1433 â”‚   â”‚   if not is_dict_like(func) and result is not None:              
    1434 â”‚   â”‚   â”‚   # GH #52849                                                
    1435 â”‚   â”‚   â”‚   if not self.as_index and is_list_like(func):               
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:190    
  in agg                                                                        
                                                                                
     187 â”‚   â”‚   â”‚   return self.apply_str()                                    
     188 â”‚   â”‚                                                                  
     189 â”‚   â”‚   if is_dict_like(func):                                         
  â±  190 â”‚   â”‚   â”‚   return self.agg_dict_like()                                
     191 â”‚   â”‚   elif is_list_like(func):                                       
     192 â”‚   â”‚   â”‚   # we require a list, but not a 'str'                       
     193 â”‚   â”‚   â”‚   return self.agg_list_like()                                
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:423    
  in agg_dict_like                                                              
                                                                                
     420 â”‚   â”‚   -------                                                        
     421 â”‚   â”‚   Result of aggregation.                                         
     422 â”‚   â”‚   """                                                            
  â±  423 â”‚   â”‚   return self.agg_or_apply_dict_like(op_name="agg")              
     424 â”‚                                                                      
     425 â”‚   def compute_dict_like(                                             
     426 â”‚   â”‚   self,                                                          
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:1608   
  in agg_or_apply_dict_like                                                     
                                                                                
    1605 â”‚   â”‚   with com.temp_setattr(                                         
    1606 â”‚   â”‚   â”‚   obj, "as_index", True, condition=hasattr(obj, "as_index")  
    1607 â”‚   â”‚   ):                                                             
  â± 1608 â”‚   â”‚   â”‚   result_index, result_data = self.compute_dict_like(        
    1609 â”‚   â”‚   â”‚   â”‚   op_name, selected_obj, selection, kwargs               
    1610 â”‚   â”‚   â”‚   )                                                          
    1611 â”‚   â”‚   result = self.wrap_results_dict_like(selected_obj, result_ind  
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:462    
  in compute_dict_like                                                          
                                                                                
     459 â”‚   â”‚   obj = self.obj                                                 
     460 â”‚   â”‚   is_groupby = isinstance(obj, (DataFrameGroupBy, SeriesGroupBy  
     461 â”‚   â”‚   func = cast(AggFuncTypeDict, self.func)                        
  â±  462 â”‚   â”‚   func = self.normalize_dictlike_arg(op_name, selected_obj, fun  
     463 â”‚   â”‚                                                                  
     464 â”‚   â”‚   is_non_unique_col = (                                          
     465 â”‚   â”‚   â”‚   selected_obj.ndim == 2                                     
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:663    
  in normalize_dictlike_arg                                                     
                                                                                
     660 â”‚   â”‚   â”‚                                                              
     661 â”‚   â”‚   â”‚   cols = Index(list(func.keys())).difference(obj.columns, s  
     662 â”‚   â”‚   â”‚   if len(cols) > 0:                                          
  â±  663 â”‚   â”‚   â”‚   â”‚   raise KeyError(f"Column(s) {list(cols)} do not exist"  
     664 â”‚   â”‚                                                                  
     665 â”‚   â”‚   aggregator_types = (list, tuple, dict)                         
     666                                                                        
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
KeyError: "Column(s) ['customer_value_score'] do not exist"
2025-03-17 09:10:50.391 503 GET /script-health-check (127.0.0.1) 977.58ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:147 in <module>                         
                                                                                
    144 â”‚   st.subheader("Average Metrics by Segment")                          
    145 â”‚                                                                       
    146 â”‚   # Calculate average metrics for each cluster                        
  â± 147 â”‚   cluster_metrics = filtered_customers.groupby('cluster').agg({       
    148 â”‚   â”‚   'monetary': 'mean',                                             
    149 â”‚   â”‚   'frequency': 'mean',                                            
    150 â”‚   â”‚   'recency': 'mean',                                              
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/groupby/generi  
  c.py:1432 in aggregate                                                        
                                                                                
    1429 â”‚   â”‚   â”‚   kwargs["engine_kwargs"] = engine_kwargs                    
    1430 â”‚   â”‚                                                                  
    1431 â”‚   â”‚   op = GroupByApply(self, func, args=args, kwargs=kwargs)        
  â± 1432 â”‚   â”‚   result = op.agg()                                              
    1433 â”‚   â”‚   if not is_dict_like(func) and result is not None:              
    1434 â”‚   â”‚   â”‚   # GH #52849                                                
    1435 â”‚   â”‚   â”‚   if not self.as_index and is_list_like(func):               
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:190    
  in agg                                                                        
                                                                                
     187 â”‚   â”‚   â”‚   return self.apply_str()                                    
     188 â”‚   â”‚                                                                  
     189 â”‚   â”‚   if is_dict_like(func):                                         
  â±  190 â”‚   â”‚   â”‚   return self.agg_dict_like()                                
     191 â”‚   â”‚   elif is_list_like(func):                                       
     192 â”‚   â”‚   â”‚   # we require a list, but not a 'str'                       
     193 â”‚   â”‚   â”‚   return self.agg_list_like()                                
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:423    
  in agg_dict_like                                                              
                                                                                
     420 â”‚   â”‚   -------                                                        
     421 â”‚   â”‚   Result of aggregation.                                         
     422 â”‚   â”‚   """                                                            
  â±  423 â”‚   â”‚   return self.agg_or_apply_dict_like(op_name="agg")              
     424 â”‚                                                                      
     425 â”‚   def compute_dict_like(                                             
     426 â”‚   â”‚   self,                                                          
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:1608   
  in agg_or_apply_dict_like                                                     
                                                                                
    1605 â”‚   â”‚   with com.temp_setattr(                                         
    1606 â”‚   â”‚   â”‚   obj, "as_index", True, condition=hasattr(obj, "as_index")  
    1607 â”‚   â”‚   ):                                                             
  â± 1608 â”‚   â”‚   â”‚   result_index, result_data = self.compute_dict_like(        
    1609 â”‚   â”‚   â”‚   â”‚   op_name, selected_obj, selection, kwargs               
    1610 â”‚   â”‚   â”‚   )                                                          
    1611 â”‚   â”‚   result = self.wrap_results_dict_like(selected_obj, result_ind  
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:462    
  in compute_dict_like                                                          
                                                                                
     459 â”‚   â”‚   obj = self.obj                                                 
     460 â”‚   â”‚   is_groupby = isinstance(obj, (DataFrameGroupBy, SeriesGroupBy  
     461 â”‚   â”‚   func = cast(AggFuncTypeDict, self.func)                        
  â±  462 â”‚   â”‚   func = self.normalize_dictlike_arg(op_name, selected_obj, fun  
     463 â”‚   â”‚                                                                  
     464 â”‚   â”‚   is_non_unique_col = (                                          
     465 â”‚   â”‚   â”‚   selected_obj.ndim == 2                                     
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:663    
  in normalize_dictlike_arg                                                     
                                                                                
     660 â”‚   â”‚   â”‚                                                              
     661 â”‚   â”‚   â”‚   cols = Index(list(func.keys())).difference(obj.columns, s  
     662 â”‚   â”‚   â”‚   if len(cols) > 0:                                          
  â±  663 â”‚   â”‚   â”‚   â”‚   raise KeyError(f"Column(s) {list(cols)} do not exist"  
     664 â”‚   â”‚                                                                  
     665 â”‚   â”‚   aggregator_types = (list, tuple, dict)                         
     666                                                                        
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
KeyError: "Column(s) ['customer_value_score'] do not exist"
2025-03-17 09:10:55.431 503 GET /script-health-check (127.0.0.1) 1045.95ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:147 in <module>                         
                                                                                
    144 â”‚   st.subheader("Average Metrics by Segment")                          
    145 â”‚                                                                       
    146 â”‚   # Calculate average metrics for each cluster                        
  â± 147 â”‚   cluster_metrics = filtered_customers.groupby('cluster').agg({       
    148 â”‚   â”‚   'monetary': 'mean',                                             
    149 â”‚   â”‚   'frequency': 'mean',                                            
    150 â”‚   â”‚   'recency': 'mean',                                              
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/groupby/generi  
  c.py:1432 in aggregate                                                        
                                                                                
    1429 â”‚   â”‚   â”‚   kwargs["engine_kwargs"] = engine_kwargs                    
    1430 â”‚   â”‚                                                                  
    1431 â”‚   â”‚   op = GroupByApply(self, func, args=args, kwargs=kwargs)        
  â± 1432 â”‚   â”‚   result = op.agg()                                              
    1433 â”‚   â”‚   if not is_dict_like(func) and result is not None:              
    1434 â”‚   â”‚   â”‚   # GH #52849                                                
    1435 â”‚   â”‚   â”‚   if not self.as_index and is_list_like(func):               
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:190    
  in agg                                                                        
                                                                                
     187 â”‚   â”‚   â”‚   return self.apply_str()                                    
     188 â”‚   â”‚                                                                  
     189 â”‚   â”‚   if is_dict_like(func):                                         
  â±  190 â”‚   â”‚   â”‚   return self.agg_dict_like()                                
     191 â”‚   â”‚   elif is_list_like(func):                                       
     192 â”‚   â”‚   â”‚   # we require a list, but not a 'str'                       
     193 â”‚   â”‚   â”‚   return self.agg_list_like()                                
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:423    
  in agg_dict_like                                                              
                                                                                
     420 â”‚   â”‚   -------                                                        
     421 â”‚   â”‚   Result of aggregation.                                         
     422 â”‚   â”‚   """                                                            
  â±  423 â”‚   â”‚   return self.agg_or_apply_dict_like(op_name="agg")              
     424 â”‚                                                                      
     425 â”‚   def compute_dict_like(                                             
     426 â”‚   â”‚   self,                                                          
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:1608   
  in agg_or_apply_dict_like                                                     
                                                                                
    1605 â”‚   â”‚   with com.temp_setattr(                                         
    1606 â”‚   â”‚   â”‚   obj, "as_index", True, condition=hasattr(obj, "as_index")  
    1607 â”‚   â”‚   ):                                                             
  â± 1608 â”‚   â”‚   â”‚   result_index, result_data = self.compute_dict_like(        
    1609 â”‚   â”‚   â”‚   â”‚   op_name, selected_obj, selection, kwargs               
    1610 â”‚   â”‚   â”‚   )                                                          
    1611 â”‚   â”‚   result = self.wrap_results_dict_like(selected_obj, result_ind  
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:462    
  in compute_dict_like                                                          
                                                                                
     459 â”‚   â”‚   obj = self.obj                                                 
     460 â”‚   â”‚   is_groupby = isinstance(obj, (DataFrameGroupBy, SeriesGroupBy  
     461 â”‚   â”‚   func = cast(AggFuncTypeDict, self.func)                        
  â±  462 â”‚   â”‚   func = self.normalize_dictlike_arg(op_name, selected_obj, fun  
     463 â”‚   â”‚                                                                  
     464 â”‚   â”‚   is_non_unique_col = (                                          
     465 â”‚   â”‚   â”‚   selected_obj.ndim == 2                                     
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:663    
  in normalize_dictlike_arg                                                     
                                                                                
     660 â”‚   â”‚   â”‚                                                              
     661 â”‚   â”‚   â”‚   cols = Index(list(func.keys())).difference(obj.columns, s  
     662 â”‚   â”‚   â”‚   if len(cols) > 0:                                          
  â±  663 â”‚   â”‚   â”‚   â”‚   raise KeyError(f"Column(s) {list(cols)} do not exist"  
     664 â”‚   â”‚                                                                  
     665 â”‚   â”‚   aggregator_types = (list, tuple, dict)                         
     666                                                                        
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
KeyError: "Column(s) ['customer_value_score'] do not exist"
2025-03-17 09:11:00.437 503 GET /script-health-check (127.0.0.1) 1040.53ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:147 in <module>                         
                                                                                
    144 â”‚   st.subheader("Average Metrics by Segment")                          
    145 â”‚                                                                       
    146 â”‚   # Calculate average metrics for each cluster                        
  â± 147 â”‚   cluster_metrics = filtered_customers.groupby('cluster').agg({       
    148 â”‚   â”‚   'monetary': 'mean',                                             
    149 â”‚   â”‚   'frequency': 'mean',                                            
    150 â”‚   â”‚   'recency': 'mean',                                              
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/groupby/generi  
  c.py:1432 in aggregate                                                        
                                                                                
    1429 â”‚   â”‚   â”‚   kwargs["engine_kwargs"] = engine_kwargs                    
    1430 â”‚   â”‚                                                                  
    1431 â”‚   â”‚   op = GroupByApply(self, func, args=args, kwargs=kwargs)        
  â± 1432 â”‚   â”‚   result = op.agg()                                              
    1433 â”‚   â”‚   if not is_dict_like(func) and result is not None:              
    1434 â”‚   â”‚   â”‚   # GH #52849                                                
    1435 â”‚   â”‚   â”‚   if not self.as_index and is_list_like(func):               
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:190    
  in agg                                                                        
                                                                                
     187 â”‚   â”‚   â”‚   return self.apply_str()                                    
     188 â”‚   â”‚                                                                  
     189 â”‚   â”‚   if is_dict_like(func):                                         
  â±  190 â”‚   â”‚   â”‚   return self.agg_dict_like()                                
     191 â”‚   â”‚   elif is_list_like(func):                                       
     192 â”‚   â”‚   â”‚   # we require a list, but not a 'str'                       
     193 â”‚   â”‚   â”‚   return self.agg_list_like()                                
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:423    
  in agg_dict_like                                                              
                                                                                
     420 â”‚   â”‚   -------                                                        
     421 â”‚   â”‚   Result of aggregation.                                         
     422 â”‚   â”‚   """                                                            
  â±  423 â”‚   â”‚   return self.agg_or_apply_dict_like(op_name="agg")              
     424 â”‚                                                                      
     425 â”‚   def compute_dict_like(                                             
     426 â”‚   â”‚   self,                                                          
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:1608   
  in agg_or_apply_dict_like                                                     
                                                                                
    1605 â”‚   â”‚   with com.temp_setattr(                                         
    1606 â”‚   â”‚   â”‚   obj, "as_index", True, condition=hasattr(obj, "as_index")  
    1607 â”‚   â”‚   ):                                                             
  â± 1608 â”‚   â”‚   â”‚   result_index, result_data = self.compute_dict_like(        
    1609 â”‚   â”‚   â”‚   â”‚   op_name, selected_obj, selection, kwargs               
    1610 â”‚   â”‚   â”‚   )                                                          
    1611 â”‚   â”‚   result = self.wrap_results_dict_like(selected_obj, result_ind  
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:462    
  in compute_dict_like                                                          
                                                                                
     459 â”‚   â”‚   obj = self.obj                                                 
     460 â”‚   â”‚   is_groupby = isinstance(obj, (DataFrameGroupBy, SeriesGroupBy  
     461 â”‚   â”‚   func = cast(AggFuncTypeDict, self.func)                        
  â±  462 â”‚   â”‚   func = self.normalize_dictlike_arg(op_name, selected_obj, fun  
     463 â”‚   â”‚                                                                  
     464 â”‚   â”‚   is_non_unique_col = (                                          
     465 â”‚   â”‚   â”‚   selected_obj.ndim == 2                                     
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:663    
  in normalize_dictlike_arg                                                     
                                                                                
     660 â”‚   â”‚   â”‚                                                              
     661 â”‚   â”‚   â”‚   cols = Index(list(func.keys())).difference(obj.columns, s  
     662 â”‚   â”‚   â”‚   if len(cols) > 0:                                          
  â±  663 â”‚   â”‚   â”‚   â”‚   raise KeyError(f"Column(s) {list(cols)} do not exist"  
     664 â”‚   â”‚                                                                  
     665 â”‚   â”‚   aggregator_types = (list, tuple, dict)                         
     666                                                                        
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
KeyError: "Column(s) ['customer_value_score'] do not exist"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:147 in <module>                         
                                                                                
    144 â”‚   st.subheader("Average Metrics by Segment")                          
    145 â”‚                                                                       
    146 â”‚   # Calculate average metrics for each cluster                        
  â± 147 â”‚   cluster_metrics = filtered_customers.groupby('cluster').agg({       
    148 â”‚   â”‚   'monetary': 'mean',                                             
    149 â”‚   â”‚   'frequency': 'mean',                                            
    150 â”‚   â”‚   'recency': 'mean',                                              
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/groupby/generi  
  c.py:1432 in aggregate                                                        
                                                                                
    1429 â”‚   â”‚   â”‚   kwargs["engine_kwargs"] = engine_kwargs                    
    1430 â”‚   â”‚                                                                  
    1431 â”‚   â”‚   op = GroupByApply(self, func, args=args, kwargs=kwargs)        
  â± 1432 â”‚   â”‚   result = op.agg()                                              
    1433 â”‚   â”‚   if not is_dict_like(func) and result is not None:              
    1434 â”‚   â”‚   â”‚   # GH #52849                                                
    1435 â”‚   â”‚   â”‚   if not self.as_index and is_list_like(func):               
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:190    
  in agg                                                                        
                                                                                
     187 â”‚   â”‚   â”‚   return self.apply_str()                                    
     188 â”‚   â”‚                                                                  
     189 â”‚   â”‚   if is_dict_like(func):                                         
  â±  190 â”‚   â”‚   â”‚   return self.agg_dict_like()                                
     191 â”‚   â”‚   elif is_list_like(func):                                       
     192 â”‚   â”‚   â”‚   # we require a list, but not a 'str'                       
     193 â”‚   â”‚   â”‚   return self.agg_list_like()                                
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:423    
  in agg_dict_like                                                              
                                                                                
     420 â”‚   â”‚   -------                                                        
     421 â”‚   â”‚   Result of aggregation.                                         
     422 â”‚   â”‚   """                                                            
  â±  423 â”‚   â”‚   return self.agg_or_apply_dict_like(op_name="agg")              
     424 â”‚                                                                      
     425 â”‚   def compute_dict_like(                                             
     426 â”‚   â”‚   self,                                                          
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:1608   
  in agg_or_apply_dict_like                                                     
                                                                                
    1605 â”‚   â”‚   with com.temp_setattr(                                         
    1606 â”‚   â”‚   â”‚   obj, "as_index", True, condition=hasattr(obj, "as_index")  
    1607 â”‚   â”‚   ):                                                             
  â± 1608 â”‚   â”‚   â”‚   result_index, result_data = self.compute_dict_like(        
    1609 â”‚   â”‚   â”‚   â”‚   op_name, selected_obj, selection, kwargs               
    1610 â”‚   â”‚   â”‚   )                                                          
    1611 â”‚   â”‚   result = self.wrap_results_dict_like(selected_obj, result_ind  
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:462    
  in compute_dict_like                                                          
                                                                                
     459 â”‚   â”‚   obj = self.obj                                                 
     460 â”‚   â”‚   is_groupby = isinstance(obj, (DataFrameGroupBy, SeriesGroupBy  
     461 â”‚   â”‚   func = cast(AggFuncTypeDict, self.func)                        
  â±  462 â”‚   â”‚   func = self.normalize_dictlike_arg(op_name, selected_obj, fun  
     463 â”‚   â”‚                                                                  
     464 â”‚   â”‚   is_non_unique_col = (                                          
     465 â”‚   â”‚   â”‚   selected_obj.ndim == 2                                     
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:663    
  in normalize_dictlike_arg                                                     
                                                                                
     660 â”‚   â”‚   â”‚                                                              
     661 â”‚   â”‚   â”‚   cols = Index(list(func.keys())).difference(obj.columns, s  
     662 â”‚   â”‚   â”‚   if len(cols) > 0:                                          
  â±  663 â”‚   â”‚   â”‚   â”‚   raise KeyError(f"Column(s) {list(cols)} do not exist"  
     664 â”‚   â”‚                                                                  
     665 â”‚   â”‚   aggregator_types = (list, tuple, dict)                         
     666                                                                        
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
KeyError: "Column(s) ['customer_value_score'] do not exist"
2025-03-17 09:11:06.574 503 GET /script-health-check (127.0.0.1) 2249.76ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:147 in <module>                         
                                                                                
    144 â”‚   st.subheader("Average Metrics by Segment")                          
    145 â”‚                                                                       
    146 â”‚   # Calculate average metrics for each cluster                        
  â± 147 â”‚   cluster_metrics = filtered_customers.groupby('cluster').agg({       
    148 â”‚   â”‚   'monetary': 'mean',                                             
    149 â”‚   â”‚   'frequency': 'mean',                                            
    150 â”‚   â”‚   'recency': 'mean',                                              
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/groupby/generi  
  c.py:1432 in aggregate                                                        
                                                                                
    1429 â”‚   â”‚   â”‚   kwargs["engine_kwargs"] = engine_kwargs                    
    1430 â”‚   â”‚                                                                  
    1431 â”‚   â”‚   op = GroupByApply(self, func, args=args, kwargs=kwargs)        
  â± 1432 â”‚   â”‚   result = op.agg()                                              
    1433 â”‚   â”‚   if not is_dict_like(func) and result is not None:              
    1434 â”‚   â”‚   â”‚   # GH #52849                                                
    1435 â”‚   â”‚   â”‚   if not self.as_index and is_list_like(func):               
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:190    
  in agg                                                                        
                                                                                
     187 â”‚   â”‚   â”‚   return self.apply_str()                                    
     188 â”‚   â”‚                                                                  
     189 â”‚   â”‚   if is_dict_like(func):                                         
  â±  190 â”‚   â”‚   â”‚   return self.agg_dict_like()                                
     191 â”‚   â”‚   elif is_list_like(func):                                       
     192 â”‚   â”‚   â”‚   # we require a list, but not a 'str'                       
     193 â”‚   â”‚   â”‚   return self.agg_list_like()                                
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:423    
  in agg_dict_like                                                              
                                                                                
     420 â”‚   â”‚   -------                                                        
     421 â”‚   â”‚   Result of aggregation.                                         
     422 â”‚   â”‚   """                                                            
  â±  423 â”‚   â”‚   return self.agg_or_apply_dict_like(op_name="agg")              
     424 â”‚                                                                      
     425 â”‚   def compute_dict_like(                                             
     426 â”‚   â”‚   self,                                                          
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:1608   
  in agg_or_apply_dict_like                                                     
                                                                                
    1605 â”‚   â”‚   with com.temp_setattr(                                         
    1606 â”‚   â”‚   â”‚   obj, "as_index", True, condition=hasattr(obj, "as_index")  
    1607 â”‚   â”‚   ):                                                             
  â± 1608 â”‚   â”‚   â”‚   result_index, result_data = self.compute_dict_like(        
    1609 â”‚   â”‚   â”‚   â”‚   op_name, selected_obj, selection, kwargs               
    1610 â”‚   â”‚   â”‚   )                                                          
    1611 â”‚   â”‚   result = self.wrap_results_dict_like(selected_obj, result_ind  
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:462    
  in compute_dict_like                                                          
                                                                                
     459 â”‚   â”‚   obj = self.obj                                                 
     460 â”‚   â”‚   is_groupby = isinstance(obj, (DataFrameGroupBy, SeriesGroupBy  
     461 â”‚   â”‚   func = cast(AggFuncTypeDict, self.func)                        
  â±  462 â”‚   â”‚   func = self.normalize_dictlike_arg(op_name, selected_obj, fun  
     463 â”‚   â”‚                                                                  
     464 â”‚   â”‚   is_non_unique_col = (                                          
     465 â”‚   â”‚   â”‚   selected_obj.ndim == 2                                     
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:663    
  in normalize_dictlike_arg                                                     
                                                                                
     660 â”‚   â”‚   â”‚                                                              
     661 â”‚   â”‚   â”‚   cols = Index(list(func.keys())).difference(obj.columns, s  
     662 â”‚   â”‚   â”‚   if len(cols) > 0:                                          
  â±  663 â”‚   â”‚   â”‚   â”‚   raise KeyError(f"Column(s) {list(cols)} do not exist"  
     664 â”‚   â”‚                                                                  
     665 â”‚   â”‚   aggregator_types = (list, tuple, dict)                         
     666                                                                        
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
KeyError: "Column(s) ['customer_value_score'] do not exist"
2025-03-17 09:11:10.415 503 GET /script-health-check (127.0.0.1) 1081.86ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:147 in <module>                         
                                                                                
    144 â”‚   st.subheader("Average Metrics by Segment")                          
    145 â”‚                                                                       
    146 â”‚   # Calculate average metrics for each cluster                        
  â± 147 â”‚   cluster_metrics = filtered_customers.groupby('cluster').agg({       
    148 â”‚   â”‚   'monetary': 'mean',                                             
    149 â”‚   â”‚   'frequency': 'mean',                                            
    150 â”‚   â”‚   'recency': 'mean',                                              
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/groupby/generi  
  c.py:1432 in aggregate                                                        
                                                                                
    1429 â”‚   â”‚   â”‚   kwargs["engine_kwargs"] = engine_kwargs                    
    1430 â”‚   â”‚                                                                  
    1431 â”‚   â”‚   op = GroupByApply(self, func, args=args, kwargs=kwargs)        
  â± 1432 â”‚   â”‚   result = op.agg()                                              
    1433 â”‚   â”‚   if not is_dict_like(func) and result is not None:              
    1434 â”‚   â”‚   â”‚   # GH #52849                                                
    1435 â”‚   â”‚   â”‚   if not self.as_index and is_list_like(func):               
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:190    
  in agg                                                                        
                                                                                
     187 â”‚   â”‚   â”‚   return self.apply_str()                                    
     188 â”‚   â”‚                                                                  
     189 â”‚   â”‚   if is_dict_like(func):                                         
  â±  190 â”‚   â”‚   â”‚   return self.agg_dict_like()                                
     191 â”‚   â”‚   elif is_list_like(func):                                       
     192 â”‚   â”‚   â”‚   # we require a list, but not a 'str'                       
     193 â”‚   â”‚   â”‚   return self.agg_list_like()                                
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:423    
  in agg_dict_like                                                              
                                                                                
     420 â”‚   â”‚   -------                                                        
     421 â”‚   â”‚   Result of aggregation.                                         
     422 â”‚   â”‚   """                                                            
  â±  423 â”‚   â”‚   return self.agg_or_apply_dict_like(op_name="agg")              
     424 â”‚                                                                      
     425 â”‚   def compute_dict_like(                                             
     426 â”‚   â”‚   self,                                                          
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:1608   
  in agg_or_apply_dict_like                                                     
                                                                                
    1605 â”‚   â”‚   with com.temp_setattr(                                         
    1606 â”‚   â”‚   â”‚   obj, "as_index", True, condition=hasattr(obj, "as_index")  
    1607 â”‚   â”‚   ):                                                             
  â± 1608 â”‚   â”‚   â”‚   result_index, result_data = self.compute_dict_like(        
    1609 â”‚   â”‚   â”‚   â”‚   op_name, selected_obj, selection, kwargs               
    1610 â”‚   â”‚   â”‚   )                                                          
    1611 â”‚   â”‚   result = self.wrap_results_dict_like(selected_obj, result_ind  
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:462    
  in compute_dict_like                                                          
                                                                                
     459 â”‚   â”‚   obj = self.obj                                                 
     460 â”‚   â”‚   is_groupby = isinstance(obj, (DataFrameGroupBy, SeriesGroupBy  
     461 â”‚   â”‚   func = cast(AggFuncTypeDict, self.func)                        
  â±  462 â”‚   â”‚   func = self.normalize_dictlike_arg(op_name, selected_obj, fun  
     463 â”‚   â”‚                                                                  
     464 â”‚   â”‚   is_non_unique_col = (                                          
     465 â”‚   â”‚   â”‚   selected_obj.ndim == 2                                     
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:663    
  in normalize_dictlike_arg                                                     
                                                                                
     660 â”‚   â”‚   â”‚                                                              
     661 â”‚   â”‚   â”‚   cols = Index(list(func.keys())).difference(obj.columns, s  
     662 â”‚   â”‚   â”‚   if len(cols) > 0:                                          
  â±  663 â”‚   â”‚   â”‚   â”‚   raise KeyError(f"Column(s) {list(cols)} do not exist"  
     664 â”‚   â”‚                                                                  
     665 â”‚   â”‚   aggregator_types = (list, tuple, dict)                         
     666                                                                        
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
KeyError: "Column(s) ['customer_value_score'] do not exist"
2025-03-17 09:11:15.374 503 GET /script-health-check (127.0.0.1) 990.65ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:147 in <module>                         
                                                                                
    144 â”‚   st.subheader("Average Metrics by Segment")                          
    145 â”‚                                                                       
    146 â”‚   # Calculate average metrics for each cluster                        
  â± 147 â”‚   cluster_metrics = filtered_customers.groupby('cluster').agg({       
    148 â”‚   â”‚   'monetary': 'mean',                                             
    149 â”‚   â”‚   'frequency': 'mean',                                            
    150 â”‚   â”‚   'recency': 'mean',                                              
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/groupby/generi  
  c.py:1432 in aggregate                                                        
                                                                                
    1429 â”‚   â”‚   â”‚   kwargs["engine_kwargs"] = engine_kwargs                    
    1430 â”‚   â”‚                                                                  
    1431 â”‚   â”‚   op = GroupByApply(self, func, args=args, kwargs=kwargs)        
  â± 1432 â”‚   â”‚   result = op.agg()                                              
    1433 â”‚   â”‚   if not is_dict_like(func) and result is not None:              
    1434 â”‚   â”‚   â”‚   # GH #52849                                                
    1435 â”‚   â”‚   â”‚   if not self.as_index and is_list_like(func):               
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:190    
  in agg                                                                        
                                                                                
     187 â”‚   â”‚   â”‚   return self.apply_str()                                    
     188 â”‚   â”‚                                                                  
     189 â”‚   â”‚   if is_dict_like(func):                                         
  â±  190 â”‚   â”‚   â”‚   return self.agg_dict_like()                                
     191 â”‚   â”‚   elif is_list_like(func):                                       
     192 â”‚   â”‚   â”‚   # we require a list, but not a 'str'                       
     193 â”‚   â”‚   â”‚   return self.agg_list_like()                                
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:423    
  in agg_dict_like                                                              
                                                                                
     420 â”‚   â”‚   -------                                                        
     421 â”‚   â”‚   Result of aggregation.                                         
     422 â”‚   â”‚   """                                                            
  â±  423 â”‚   â”‚   return self.agg_or_apply_dict_like(op_name="agg")              
     424 â”‚                                                                      
     425 â”‚   def compute_dict_like(                                             
     426 â”‚   â”‚   self,                                                          
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:1608   
  in agg_or_apply_dict_like                                                     
                                                                                
    1605 â”‚   â”‚   with com.temp_setattr(                                         
    1606 â”‚   â”‚   â”‚   obj, "as_index", True, condition=hasattr(obj, "as_index")  
    1607 â”‚   â”‚   ):                                                             
  â± 1608 â”‚   â”‚   â”‚   result_index, result_data = self.compute_dict_like(        
    1609 â”‚   â”‚   â”‚   â”‚   op_name, selected_obj, selection, kwargs               
    1610 â”‚   â”‚   â”‚   )                                                          
    1611 â”‚   â”‚   result = self.wrap_results_dict_like(selected_obj, result_ind  
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:462    
  in compute_dict_like                                                          
                                                                                
     459 â”‚   â”‚   obj = self.obj                                                 
     460 â”‚   â”‚   is_groupby = isinstance(obj, (DataFrameGroupBy, SeriesGroupBy  
     461 â”‚   â”‚   func = cast(AggFuncTypeDict, self.func)                        
  â±  462 â”‚   â”‚   func = self.normalize_dictlike_arg(op_name, selected_obj, fun  
     463 â”‚   â”‚                                                                  
     464 â”‚   â”‚   is_non_unique_col = (                                          
     465 â”‚   â”‚   â”‚   selected_obj.ndim == 2                                     
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:663    
  in normalize_dictlike_arg                                                     
                                                                                
     660 â”‚   â”‚   â”‚                                                              
     661 â”‚   â”‚   â”‚   cols = Index(list(func.keys())).difference(obj.columns, s  
     662 â”‚   â”‚   â”‚   if len(cols) > 0:                                          
  â±  663 â”‚   â”‚   â”‚   â”‚   raise KeyError(f"Column(s) {list(cols)} do not exist"  
     664 â”‚   â”‚                                                                  
     665 â”‚   â”‚   aggregator_types = (list, tuple, dict)                         
     666                                                                        
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
KeyError: "Column(s) ['customer_value_score'] do not exist"
2025-03-17 09:11:20.548 503 GET /script-health-check (127.0.0.1) 1133.57ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:147 in <module>                         
                                                                                
    144 â”‚   st.subheader("Average Metrics by Segment")                          
    145 â”‚                                                                       
    146 â”‚   # Calculate average metrics for each cluster                        
  â± 147 â”‚   cluster_metrics = filtered_customers.groupby('cluster').agg({       
    148 â”‚   â”‚   'monetary': 'mean',                                             
    149 â”‚   â”‚   'frequency': 'mean',                                            
    150 â”‚   â”‚   'recency': 'mean',                                              
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/groupby/generi  
  c.py:1432 in aggregate                                                        
                                                                                
    1429 â”‚   â”‚   â”‚   kwargs["engine_kwargs"] = engine_kwargs                    
    1430 â”‚   â”‚                                                                  
    1431 â”‚   â”‚   op = GroupByApply(self, func, args=args, kwargs=kwargs)        
  â± 1432 â”‚   â”‚   result = op.agg()                                              
    1433 â”‚   â”‚   if not is_dict_like(func) and result is not None:              
    1434 â”‚   â”‚   â”‚   # GH #52849                                                
    1435 â”‚   â”‚   â”‚   if not self.as_index and is_list_like(func):               
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:190    
  in agg                                                                        
                                                                                
     187 â”‚   â”‚   â”‚   return self.apply_str()                                    
     188 â”‚   â”‚                                                                  
     189 â”‚   â”‚   if is_dict_like(func):                                         
  â±  190 â”‚   â”‚   â”‚   return self.agg_dict_like()                                
     191 â”‚   â”‚   elif is_list_like(func):                                       
     192 â”‚   â”‚   â”‚   # we require a list, but not a 'str'                       
     193 â”‚   â”‚   â”‚   return self.agg_list_like()                                
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:423    
  in agg_dict_like                                                              
                                                                                
     420 â”‚   â”‚   -------                                                        
     421 â”‚   â”‚   Result of aggregation.                                         
     422 â”‚   â”‚   """                                                            
  â±  423 â”‚   â”‚   return self.agg_or_apply_dict_like(op_name="agg")              
     424 â”‚                                                                      
     425 â”‚   def compute_dict_like(                                             
     426 â”‚   â”‚   self,                                                          
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:1608   
  in agg_or_apply_dict_like                                                     
                                                                                
    1605 â”‚   â”‚   with com.temp_setattr(                                         
    1606 â”‚   â”‚   â”‚   obj, "as_index", True, condition=hasattr(obj, "as_index")  
    1607 â”‚   â”‚   ):                                                             
  â± 1608 â”‚   â”‚   â”‚   result_index, result_data = self.compute_dict_like(        
    1609 â”‚   â”‚   â”‚   â”‚   op_name, selected_obj, selection, kwargs               
    1610 â”‚   â”‚   â”‚   )                                                          
    1611 â”‚   â”‚   result = self.wrap_results_dict_like(selected_obj, result_ind  
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:462    
  in compute_dict_like                                                          
                                                                                
     459 â”‚   â”‚   obj = self.obj                                                 
     460 â”‚   â”‚   is_groupby = isinstance(obj, (DataFrameGroupBy, SeriesGroupBy  
     461 â”‚   â”‚   func = cast(AggFuncTypeDict, self.func)                        
  â±  462 â”‚   â”‚   func = self.normalize_dictlike_arg(op_name, selected_obj, fun  
     463 â”‚   â”‚                                                                  
     464 â”‚   â”‚   is_non_unique_col = (                                          
     465 â”‚   â”‚   â”‚   selected_obj.ndim == 2                                     
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:663    
  in normalize_dictlike_arg                                                     
                                                                                
     660 â”‚   â”‚   â”‚                                                              
     661 â”‚   â”‚   â”‚   cols = Index(list(func.keys())).difference(obj.columns, s  
     662 â”‚   â”‚   â”‚   if len(cols) > 0:                                          
  â±  663 â”‚   â”‚   â”‚   â”‚   raise KeyError(f"Column(s) {list(cols)} do not exist"  
     664 â”‚   â”‚                                                                  
     665 â”‚   â”‚   aggregator_types = (list, tuple, dict)                         
     666                                                                        
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
KeyError: "Column(s) ['customer_value_score'] do not exist"
2025-03-17 09:11:25.272 503 GET /script-health-check (127.0.0.1) 863.17ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:147 in <module>                         
                                                                                
    144 â”‚   st.subheader("Average Metrics by Segment")                          
    145 â”‚                                                                       
    146 â”‚   # Calculate average metrics for each cluster                        
  â± 147 â”‚   cluster_metrics = filtered_customers.groupby('cluster').agg({       
    148 â”‚   â”‚   'monetary': 'mean',                                             
    149 â”‚   â”‚   'frequency': 'mean',                                            
    150 â”‚   â”‚   'recency': 'mean',                                              
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/groupby/generi  
  c.py:1432 in aggregate                                                        
                                                                                
    1429 â”‚   â”‚   â”‚   kwargs["engine_kwargs"] = engine_kwargs                    
    1430 â”‚   â”‚                                                                  
    1431 â”‚   â”‚   op = GroupByApply(self, func, args=args, kwargs=kwargs)        
  â± 1432 â”‚   â”‚   result = op.agg()                                              
    1433 â”‚   â”‚   if not is_dict_like(func) and result is not None:              
    1434 â”‚   â”‚   â”‚   # GH #52849                                                
    1435 â”‚   â”‚   â”‚   if not self.as_index and is_list_like(func):               
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:190    
  in agg                                                                        
                                                                                
     187 â”‚   â”‚   â”‚   return self.apply_str()                                    
     188 â”‚   â”‚                                                                  
     189 â”‚   â”‚   if is_dict_like(func):                                         
  â±  190 â”‚   â”‚   â”‚   return self.agg_dict_like()                                
     191 â”‚   â”‚   elif is_list_like(func):                                       
     192 â”‚   â”‚   â”‚   # we require a list, but not a 'str'                       
     193 â”‚   â”‚   â”‚   return self.agg_list_like()                                
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:423    
  in agg_dict_like                                                              
                                                                                
     420 â”‚   â”‚   -------                                                        
     421 â”‚   â”‚   Result of aggregation.                                         
     422 â”‚   â”‚   """                                                            
  â±  423 â”‚   â”‚   return self.agg_or_apply_dict_like(op_name="agg")              
     424 â”‚                                                                      
     425 â”‚   def compute_dict_like(                                             
     426 â”‚   â”‚   self,                                                          
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:1608   
  in agg_or_apply_dict_like                                                     
                                                                                
    1605 â”‚   â”‚   with com.temp_setattr(                                         
    1606 â”‚   â”‚   â”‚   obj, "as_index", True, condition=hasattr(obj, "as_index")  
    1607 â”‚   â”‚   ):                                                             
  â± 1608 â”‚   â”‚   â”‚   result_index, result_data = self.compute_dict_like(        
    1609 â”‚   â”‚   â”‚   â”‚   op_name, selected_obj, selection, kwargs               
    1610 â”‚   â”‚   â”‚   )                                                          
    1611 â”‚   â”‚   result = self.wrap_results_dict_like(selected_obj, result_ind  
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:462    
  in compute_dict_like                                                          
                                                                                
     459 â”‚   â”‚   obj = self.obj                                                 
     460 â”‚   â”‚   is_groupby = isinstance(obj, (DataFrameGroupBy, SeriesGroupBy  
     461 â”‚   â”‚   func = cast(AggFuncTypeDict, self.func)                        
  â±  462 â”‚   â”‚   func = self.normalize_dictlike_arg(op_name, selected_obj, fun  
     463 â”‚   â”‚                                                                  
     464 â”‚   â”‚   is_non_unique_col = (                                          
     465 â”‚   â”‚   â”‚   selected_obj.ndim == 2                                     
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:663    
  in normalize_dictlike_arg                                                     
                                                                                
     660 â”‚   â”‚   â”‚                                                              
     661 â”‚   â”‚   â”‚   cols = Index(list(func.keys())).difference(obj.columns, s  
     662 â”‚   â”‚   â”‚   if len(cols) > 0:                                          
  â±  663 â”‚   â”‚   â”‚   â”‚   raise KeyError(f"Column(s) {list(cols)} do not exist"  
     664 â”‚   â”‚                                                                  
     665 â”‚   â”‚   aggregator_types = (list, tuple, dict)                         
     666                                                                        
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
KeyError: "Column(s) ['customer_value_score'] do not exist"
2025-03-17 09:11:30.539 503 GET /script-health-check (127.0.0.1) 1101.78ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/exec_code.py:121 in exec_func_with_error_handling                        
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/streamlit/runtime/scriptru  
  nner/script_runner.py:593 in code_to_exec                                     
                                                                                
  /mount/src/blank-app/streamlit_app.py:147 in <module>                         
                                                                                
    144 â”‚   st.subheader("Average Metrics by Segment")                          
    145 â”‚                                                                       
    146 â”‚   # Calculate average metrics for each cluster                        
  â± 147 â”‚   cluster_metrics = filtered_customers.groupby('cluster').agg({       
    148 â”‚   â”‚   'monetary': 'mean',                                             
    149 â”‚   â”‚   'frequency': 'mean',                                            
    150 â”‚   â”‚   'recency': 'mean',                                              
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/groupby/generi  
  c.py:1432 in aggregate                                                        
                                                                                
    1429 â”‚   â”‚   â”‚   kwargs["engine_kwargs"] = engine_kwargs                    
    1430 â”‚   â”‚                                                                  
    1431 â”‚   â”‚   op = GroupByApply(self, func, args=args, kwargs=kwargs)        
  â± 1432 â”‚   â”‚   result = op.agg()                                              
    1433 â”‚   â”‚   if not is_dict_like(func) and result is not None:              
    1434 â”‚   â”‚   â”‚   # GH #52849                                                
    1435 â”‚   â”‚   â”‚   if not self.as_index and is_list_like(func):               
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:190    
  in agg                                                                        
                                                                                
     187 â”‚   â”‚   â”‚   return self.apply_str()                                    
     188 â”‚   â”‚                                                                  
     189 â”‚   â”‚   if is_dict_like(func):                                         
  â±  190 â”‚   â”‚   â”‚   return self.agg_dict_like()                                
     191 â”‚   â”‚   elif is_list_like(func):                                       
     192 â”‚   â”‚   â”‚   # we require a list, but not a 'str'                       
     193 â”‚   â”‚   â”‚   return self.agg_list_like()                                
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:423    
  in agg_dict_like                                                              
                                                                                
     420 â”‚   â”‚   -------                                                        
     421 â”‚   â”‚   Result of aggregation.                                         
     422 â”‚   â”‚   """                                                            
  â±  423 â”‚   â”‚   return self.agg_or_apply_dict_like(op_name="agg")              
     424 â”‚                                                                      
     425 â”‚   def compute_dict_like(                                             
     426 â”‚   â”‚   self,                                                          
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:1608   
  in agg_or_apply_dict_like                                                     
                                                                                
    1605 â”‚   â”‚   with com.temp_setattr(                                         
    1606 â”‚   â”‚   â”‚   obj, "as_index", True, condition=hasattr(obj, "as_index")  
    1607 â”‚   â”‚   ):                                                             
  â± 1608 â”‚   â”‚   â”‚   result_index, result_data = self.compute_dict_like(        
    1609 â”‚   â”‚   â”‚   â”‚   op_name, selected_obj, selection, kwargs               
    1610 â”‚   â”‚   â”‚   )                                                          
    1611 â”‚   â”‚   result = self.wrap_results_dict_like(selected_obj, result_ind  
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:462    
  in compute_dict_like                                                          
                                                                                
     459 â”‚   â”‚   obj = self.obj                                                 
     460 â”‚   â”‚   is_groupby = isinstance(obj, (DataFrameGroupBy, SeriesGroupBy  
     461 â”‚   â”‚   func = cast(AggFuncTypeDict, self.func)                        
  â±  462 â”‚   â”‚   func = self.normalize_dictlike_arg(op_name, selected_obj, fun  
     463 â”‚   â”‚                                                                  
     464 â”‚   â”‚   is_non_unique_col = (                                          
     465 â”‚   â”‚   â”‚   selected_obj.ndim == 2                                     
                                                                                
  /home/adminuser/venv/lib/python3.12/site-packages/pandas/core/apply.py:663    
  in normalize_dictlike_arg                                                     
                                                                                
     660 â”‚   â”‚   â”‚                                                              
     661 â”‚   â”‚   â”‚   cols = Index(list(func.keys())).difference(obj.columns, s  
     662 â”‚   â”‚   â”‚   if len(cols) > 0:                                          
  â±  663 â”‚   â”‚   â”‚   â”‚   raise KeyError(f"Column(s) {list(cols)} do not exist"  
     664 â”‚   â”‚                                                                  
     665 â”‚   â”‚   aggregator_types = (list, tuple, dict)                         
     666                                                                        
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
KeyError: "Column(s) ['customer_value_score'] do not exist"
2025-03-17 09:11:35.479 503 GET /script-health-check (127.0.0.1) 1044.92ms